{
	"info": {
		"_postman_id": "revpay-connect-2024-v1",
		"name": "Revpay Connect eTIMS Gateway - Complete API",
		"description": "Complete API collection for testing Revpay Connect eTIMS Gateway with both OSCU and VSCU integration endpoints.\n\nThis collection includes:\n- Company onboarding and management\n- OSCU device registration and transactions\n- VSCU virtual device management\n- Integrator service endpoints\n- Analytics and compliance reporting\n- System monitoring and health checks\n\nBase URL: http://localhost:8000\nAuthentication: Token-based",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "1. System Health & Authentication",
			"item": [
				{
					"name": "Health Check",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/health/",
							"host": ["{{base_url}}"],
							"path": ["health", ""]
						}
					}
				},
				{
					"name": "Get API Token",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 200) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set('auth_token', jsonData.token);",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"username\": \"admin\",\n    \"password\": \"admin123\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api-token-auth/",
							"host": ["{{base_url}}"],
							"path": ["api-token-auth", ""]
						}
					}
				}
			]
		},
		{
			"name": "2. Company Onboarding",
			"item": [
				{
					"name": "Create Company",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set('company_id', jsonData.id);",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"company_name\": \"{{test_company_name}}\",\n    \"tin\": \"{{test_tin}}\",\n    \"contact_email\": \"{{test_email}}\",\n    \"contact_phone\": \"+254700123456\",\n    \"address\": \"123 Test Street, Nairobi\",\n    \"business_type\": \"retail\",\n    \"subscription_plan\": \"basic\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/companies/",
							"host": ["{{base_url}}"],
							"path": ["api", "companies", ""]
						}
					}
				},
				{
					"name": "Get Company Details",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/companies/{{company_id}}/",
							"host": ["{{base_url}}"],
							"path": ["api", "companies", "{{company_id}}", ""]
						}
					}
				}
			]
		},
		{
			"name": "3. OSCU Integration",
			"item": [
				{
					"name": "Register OSCU Device",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set('device_id', jsonData.device_id);",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"company_id\": \"{{company_id}}\",\n    \"device_type\": \"oscu\",\n    \"integration_type\": \"pos\",\n    \"device_name\": \"Main POS Terminal\",\n    \"serial_number\": \"{{test_serial_number}}\",\n    \"tin\": \"{{test_tin}}\",\n    \"bhf_id\": \"{{test_bhf_id}}\",\n    \"dvc_srl_no\": \"{{test_serial_number}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/devices/",
							"host": ["{{base_url}}"],
							"path": ["api", "devices", ""]
						}
					}
				},
				{
					"name": "Process OSCU Sale",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set('invoice_id', jsonData.invoice_id);",
									"    pm.environment.set('invoice_no', jsonData.invoice_no);",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"device_id\": \"{{device_id}}\",\n    \"customer_name\": \"John Doe\",\n    \"customer_pin\": \"A123456789P\",\n    \"sales_type\": \"normal\",\n    \"payment_type\": \"cash\",\n    \"items\": [\n        {\n            \"item_code\": \"ITEM001\",\n            \"item_name\": \"Test Product\",\n            \"quantity\": 2,\n            \"unit_price\": 1000.00,\n            \"tax_type\": \"A\",\n            \"discount_amount\": 0\n        }\n    ]\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/sales/",
							"host": ["{{base_url}}"],
							"path": ["api", "sales", ""]
						}
					}
				}
			]
		},
		{
			"name": "4. VSCU Integration",
			"item": [
				{
					"name": "Register VSCU Device",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"if (pm.response.code === 201) {",
									"    var jsonData = pm.response.json();",
									"    pm.environment.set('virtual_device_id', jsonData.virtual_device_id);",
									"}"
								]
							}
						}
					],
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"company_id\": \"{{company_id}}\",\n    \"device_type\": \"vscu\",\n    \"integration_type\": \"ecommerce\",\n    \"device_name\": \"E-commerce Store\",\n    \"tin\": \"{{test_tin}}\",\n    \"bhf_id\": \"{{test_bhf_id}}\",\n    \"api_endpoint\": \"https://mystore.com/etims-webhook\",\n    \"webhook_url\": \"https://mystore.com/etims-callback\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/vscu/devices/",
							"host": ["{{base_url}}"],
							"path": ["api", "vscu", "devices", ""]
						}
					}
				},
				{
					"name": "Process VSCU Transaction",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"virtual_device_id\": \"{{virtual_device_id}}\",\n    \"customer_name\": \"Jane Smith\",\n    \"customer_email\": \"jane@email.com\",\n    \"sales_type\": \"normal\",\n    \"payment_type\": \"card\",\n    \"items\": [\n        {\n            \"item_code\": \"ECOM001\",\n            \"item_name\": \"Online Product\",\n            \"quantity\": 1,\n            \"unit_price\": 2500.00,\n            \"tax_type\": \"A\",\n            \"discount_amount\": 250.00\n        }\n    ]\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/vscu/transactions/",
							"host": ["{{base_url}}"],
							"path": ["api", "vscu", "transactions", ""]
						}
					}
				}
			]
		},
		{
			"name": "5. Integrator Services",
			"item": [
				{
					"name": "Onboard Client (OSCU)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"company_data\": {\n        \"company_name\": \"OSCU Client Ltd\",\n        \"tin\": \"98765432109\",\n        \"contact_email\": \"oscu@client.com\",\n        \"contact_phone\": \"+254700987654\",\n        \"address\": \"456 Client Ave, Mombasa\",\n        \"business_type\": \"restaurant\"\n    },\n    \"device_data\": {\n        \"device_type\": \"oscu\",\n        \"integration_type\": \"pos\",\n        \"device_name\": \"Restaurant POS\",\n        \"serial_number\": \"REST-POS-001\",\n        \"bhf_id\": \"002\"\n    },\n    \"subscription_plan\": \"premium\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/integrator/onboard/",
							"host": ["{{base_url}}"],
							"path": ["api", "integrator", "onboard", ""]
						}
					}
				},
				{
					"name": "Onboard Client (VSCU)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"company_data\": {\n        \"company_name\": \"VSCU E-Store Ltd\",\n        \"tin\": \"11223344556\",\n        \"contact_email\": \"vscu@estore.com\",\n        \"contact_phone\": \"+254700111222\",\n        \"address\": \"789 Digital Plaza, Nairobi\",\n        \"business_type\": \"ecommerce\"\n    },\n    \"device_data\": {\n        \"device_type\": \"vscu\",\n        \"integration_type\": \"ecommerce\",\n        \"device_name\": \"Online Store\",\n        \"bhf_id\": \"003\",\n        \"api_endpoint\": \"https://estore.com/etims\",\n        \"webhook_url\": \"https://estore.com/webhook\"\n    },\n    \"subscription_plan\": \"enterprise\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/integrator/onboard/",
							"host": ["{{base_url}}"],
							"path": ["api", "integrator", "onboard", ""]
						}
					}
				},
				{
					"name": "Get Integration Capabilities",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/integrator/capabilities/",
							"host": ["{{base_url}}"],
							"path": ["api", "integrator", "capabilities", ""]
						}
					}
				}
			]
		},
		{
			"name": "6. Analytics & Reporting",
			"item": [
				{
					"name": "Company Analytics",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/analytics/company/{{company_id}}/",
							"host": ["{{base_url}}"],
							"path": ["api", "analytics", "company", "{{company_id}}", ""]
						}
					}
				},
				{
					"name": "System Analytics",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/analytics/system/",
							"host": ["{{base_url}}"],
							"path": ["api", "analytics", "system", ""]
						}
					}
				},
				{
					"name": "Compliance Report",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/compliance/reports/?company_id={{company_id}}&report_type=daily",
							"host": ["{{base_url}}"],
							"path": ["api", "compliance", "reports", ""],
							"query": [
								{
									"key": "company_id",
									"value": "{{company_id}}"
								},
								{
									"key": "report_type",
									"value": "daily"
								}
							]
						}
					}
				}
			]
		},
		{
			"name": "7. System Management",
			"item": [
				{
					"name": "List API Logs",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/logs/?company_id={{company_id}}&limit=10",
							"host": ["{{base_url}}"],
							"path": ["api", "logs", ""],
							"query": [
								{
									"key": "company_id",
									"value": "{{company_id}}"
								},
								{
									"key": "limit",
									"value": "10"
								}
							]
						}
					}
				},
				{
					"name": "Environment Status",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/environment/status/",
							"host": ["{{base_url}}"],
							"path": ["api", "environment", "status", ""]
						}
					}
				},
				{
					"name": "Switch Environment",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}"
							},
							{
								"key": "Content-Type",
								"value": "application/json"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n    \"environment\": \"sandbox\",\n    \"company_id\": \"{{company_id}}\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/environment/switch/",
							"host": ["{{base_url}}"],
							"path": ["api", "environment", "switch", ""]
						}
					}
				}
			]
		}
	]
}
