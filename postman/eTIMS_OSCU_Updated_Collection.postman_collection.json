{
	"info": {
		"_postman_id": "updated-2025-10-13",
		"name": "eTIMS OSCU Integration - Complete Workflow",
		"description": "Updated Postman collection with real working data for complete KRA eTIMS OSCU testing workflow.\n\nAuthentication Token: adadec42f0aa4330b7df1392510ed347f0f72fd1\nBase URL: http://localhost:8000\n\nWorking Test Data:\n- Company ID: 7c209984-2ead-41dd-866c-33bb1658a3cb\n- TIN: 98765432109\n- Device Serial: REAL009 (with active CMC key)\n- Company: Test Company Ltd\n\nWorkflow Order:\n1. Health Check & Test Connection\n2. Company Onboarding\n3. Device Initialization\n4. Generate RSA Keys\n5. Sales Transaction\n6. Item Synchronization\n7. Monitor Logs & Invoices\n\nRecent Updates:\n- Fixed crypto signature generation\n- Added TIN parameter to item sync\n- Fixed RSA key generation endpoint\n- Updated authentication headers",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
	},
	"item": [
		{
			"name": "1. System Health",
			"item": [
				{
					"name": "Health Check",
					"request": {
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{base_url}}/health/",
							"host": ["{{base_url}}"],
							"path": ["health", ""]
						}
					},
					"response": []
				},
				{
					"name": "Test Connection",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{}"
						},
						"url": {
							"raw": "{{base_url}}/api/device/test-connection/",
							"host": ["{{base_url}}"],
							"path": ["api", "device", "test-connection", ""]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "2. Company Management",
			"item": [
				{
					"name": "List Companies",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/companies/",
							"host": ["{{base_url}}"],
							"path": ["api", "companies", ""]
						}
					},
					"response": []
				},
				{
					"name": "Onboard New Company",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"company_name\": \"New Test Company Ltd\",\n  \"tin\": \"{{new_tin}}\",\n  \"contact_person\": \"John Doe\",\n  \"contact_email\": \"john@newtest.com\",\n  \"contact_phone\": \"+254700123456\",\n  \"business_address\": \"Nairobi, Kenya\",\n  \"business_type\": \"retail\",\n  \"subscription_plan\": \"basic\",\n  \"device_name\": \"POS Device 001\",\n  \"bhf_id\": \"000\",\n  \"serial_number\": \"{{new_device_serial}}\",\n  \"pos_version\": \"1.0\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/onboard/",
							"host": ["{{base_url}}"],
							"path": ["api", "onboard", ""]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "3. Device Management",
			"item": [
				{
					"name": "Initialize Device (Existing Company)",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"company_id\": \"{{company_id}}\",\n  \"tin\": \"{{tin}}\",\n  \"bhf_id\": \"000\",\n  \"device_serial\": \"{{device_serial}}\",\n  \"device_name\": \"Test Device with CMC\",\n  \"pos_version\": \"1.0\"\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/device/init/",
							"host": ["{{base_url}}"],
							"path": ["api", "device", "init", ""]
						}
					},
					"response": []
				},
				{
					"name": "Generate RSA Keys for Device",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{}"
						},
						"url": {
							"raw": "{{base_url}}/api/device/{{device_serial}}/generate-keys/",
							"host": ["{{base_url}}"],
							"path": ["api", "device", "{{device_serial}}", "generate-keys", ""]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "4. Sales Transactions",
			"item": [
				{
					"name": "Process Sales Transaction",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"device_serial_number\": \"{{device_serial}}\",\n  \"invoice_no\": \"INV{{$randomInt}}\",\n  \"tin\": \"{{tin}}\",\n  \"customer_name\": \"Test Customer\",\n  \"payment_method\": \"CASH\",\n  \"transaction_date\": \"{{$isoTimestamp}}\",\n  \"currency\": \"KES\",\n  \"items\": [\n    {\n      \"item_code\": \"TEST001\",\n      \"item_name\": \"Test Product\",\n      \"quantity\": 1,\n      \"unit_price\": 100.00,\n      \"tax_type\": \"A\",\n      \"tax_rate\": 16.0,\n      \"unit_of_measure\": \"EA\"\n    }\n  ]\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/sales/",
							"host": ["{{base_url}}"],
							"path": ["api", "sales", ""]
						}
					},
					"response": []
				},
				{
					"name": "Process Multiple Items Transaction",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"device_serial_number\": \"{{device_serial}}\",\n  \"invoice_no\": \"INV{{$randomInt}}\",\n  \"tin\": \"{{tin}}\",\n  \"customer_name\": \"Multi-Item Customer\",\n  \"payment_method\": \"CARD\",\n  \"transaction_date\": \"{{$isoTimestamp}}\",\n  \"currency\": \"KES\",\n  \"items\": [\n    {\n      \"item_code\": \"TEST001\",\n      \"item_name\": \"Test Product 1\",\n      \"quantity\": 2,\n      \"unit_price\": 150.00,\n      \"tax_type\": \"A\",\n      \"tax_rate\": 16.0,\n      \"unit_of_measure\": \"EA\"\n    },\n    {\n      \"item_code\": \"TEST002\",\n      \"item_name\": \"Test Product 2\",\n      \"quantity\": 1,\n      \"unit_price\": 250.00,\n      \"tax_type\": \"B\",\n      \"tax_rate\": 8.0,\n      \"unit_of_measure\": \"KG\"\n    }\n  ]\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/sales/",
							"host": ["{{base_url}}"],
							"path": ["api", "sales", ""]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "5. Monitoring & Logs",
			"item": [
				{
					"name": "View API Logs",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/logs/",
							"host": ["{{base_url}}"],
							"path": ["api", "logs", ""]
						}
					},
					"response": []
				},
				{
					"name": "View Invoices",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/invoices/",
							"host": ["{{base_url}}"],
							"path": ["api", "invoices", ""]
						}
					},
					"response": []
				},
				{
					"name": "System Dashboard",
					"request": {
						"method": "GET",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}",
								"type": "text"
							}
						],
						"url": {
							"raw": "{{base_url}}/api/dashboard/",
							"host": ["{{base_url}}"],
							"path": ["api", "dashboard", ""]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "6. Item Management",
			"item": [
				{
					"name": "Sync Items",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Authorization",
								"value": "Token {{auth_token}}",
								"type": "text"
							},
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"tin\": \"{{tin}}\",\n  \"bhf_id\": \"000\",\n  \"items\": [\n    {\n      \"item_code\": \"TEST001\",\n      \"item_name\": \"Test Product 1\",\n      \"tax_type\": \"A\",\n      \"unit_price\": 100.00,\n      \"unit_of_measure\": \"EA\"\n    },\n    {\n      \"item_code\": \"TEST002\",\n      \"item_name\": \"Test Product 2\",\n      \"tax_type\": \"B\",\n      \"unit_price\": 250.00,\n      \"unit_of_measure\": \"KG\"\n    }\n  ]\n}"
						},
						"url": {
							"raw": "{{base_url}}/api/item/sync/",
							"host": ["{{base_url}}"],
							"path": ["api", "item", "sync", ""]
						}
					},
					"response": []
				}
			]
		},
		{
			"name": "7. KRA Direct Testing",
			"item": [
				{
					"name": "KRA Sandbox - Device Check",
					"request": {
						"method": "POST",
						"header": [
							{
								"key": "Content-Type",
								"value": "application/json",
								"type": "text"
							}
						],
						"body": {
							"mode": "raw",
							"raw": "{\n  \"tin\": \"{{tin}}\",\n  \"bhfId\": \"000\",\n  \"dvcSrlNo\": \"{{device_serial}}\",\n  \"dvcNm\": \"Test Device\"\n}"
						},
						"url": {
							"raw": "https://etims-api-sbx.kra.go.ke/etims-api/selectInitOsdcInfo",
							"protocol": "https",
							"host": ["etims-api-sbx", "kra", "go", "ke"],
							"path": ["etims-api", "selectInitOsdcInfo"]
						}
					},
					"response": []
				}
			]
		}
	],
	"variable": [
		{
			"key": "base_url",
			"value": "http://localhost:8000"
		},
		{
			"key": "auth_token",
			"value": "adadec42f0aa4330b7df1392510ed347f0f72fd1"
		},
		{
			"key": "company_id",
			"value": "7c209984-2ead-41dd-866c-33bb1658a3cb"
		},
		{
			"key": "tin",
			"value": "98765432109"
		},
		{
			"key": "device_serial",
			"value": "REAL009"
		},
		{
			"key": "new_tin",
			"value": "99988877766"
		},
		{
			"key": "new_device_serial",
			"value": "REAL010"
		}
	]
}
